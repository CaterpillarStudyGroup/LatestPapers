
# Physics-based fluid simulation in computer graphics: Survey, research trends, and challenges

**摘要**：基于物理的流体模拟在计算机图形学领域正扮演着日益重要的角色。该领域的最新方法极大地提升了复杂视觉效果的生成能力及其计算效率。新颖的技术不断涌现，用以处理复杂边界、多相流体、气液界面以及精细细节等问题。机器学习、图像处理与流体控制技术的并行应用，带来了众多引人入胜且新颖的研究视角。在本综述中，我们介绍了支撑基于物理的流体模拟的理论概念及其实际实现方法，旨在为刚接触该领域的研究人员以及资深学者探索基于物理的流体模拟（尤其聚焦过去十年的发展）提供一份指南。基于该领域近期发表的文献分布，我们将综述内容结构化，涵盖物理背景、离散化方法、解决可扩展性问题的计算方法、流体与其他材料及界面的相互作用，以及用于表面细节表现与控制的各类方法。从实践角度出发，我们还概述了实现上述方法的现有可用工具或代码库。    

1 北京科技大学北京材料基因工程高精尖创新中心、智能科学与技术学院、顺德创新学院，北京 100083，中国。    
电子邮件：X. Wang, wangxiaokun@ustb.edu.cn; J. Wang, no4724722205@163.com; C. Song, 18519225284@163.com; X. Ban, banxj@ustb.edu.cn ( )。   

2 伯恩茅斯大学媒体与传播学院国家计算机动画中心，普尔 BH12 5BB，英国。    
电子邮件：J. Chang, jchang@bournemouth.ac.uk ( ); J. J. Zhang, jzhang@bournemouth.ac.uk。  

3 格罗宁根大学伯努利研究所，格罗宁根 9700 AK，荷兰。  
电子邮件：Y. Xu, Yanrui.xu@rug.nl; J. Kosinka, j.kosinka@rug.nl。  

4 北京大学计算机学院，北京 100871，中国。  
电子邮件：sinuoliu@pku.edu.cn。  

5 南开大学计算机学院 TMCC，天津 300350，中国。  
电子邮件：rb@nankai.edu.cn。   

6 乌得勒支大学信息与计算科学系，乌得勒支 3584 CC，荷兰。   
电子邮件：a.c.telea@uu.nl。   

7 斯旺西大学建模、数据与人工智能辛基维奇研究所，斯旺西 SA1 8EN，英国。  
电子邮件：c.f.li@swansea.ac.uk。  

8 辽宁省材料研究院材料智能技术研究所，沈阳 110004，中国。  

∗ 王晓坤与徐砚锐对本文贡献相同。   
收稿日期：2023年1月26日；接受日期：2023年7月1日   

关键词 计算机图形学；物理仿真；流体仿真；流体耦合   

1. 引言    
流体作为自然环境中无处不在的存在，是视觉仿真中至关重要的元素。其多变的运动形态与复杂的行为特性，使其成为图形仿真中极具吸引力却又难以描述和计算的对象。正因如此，流体仿真长期以来一直是计算机图形学最重要的研究方向之一。随着计算机技术的发展，直接基于流体动力学控制方程模拟复杂流体现象已成为可能。为此，学界提出了多种基于物理的方法与技术，涵盖从简单但不精确的模型，到逐步优化、能捕捉交互介质中日益复杂动力学的精密技术。这些方法在假设条件、建模能力及底层实现技术等方面差异显著，其多样性使得理解当前前沿进展颇具挑战性，尤其对从业者和新进入者而言更是如此。    

本综述旨在通过梳理计算机图形学中基于物理的流体仿真的主要研究主题及其在过去十年间的新趋势，应对上述理解挑战。文中探讨了流体仿真的不同目标、为实现这些目标提出的技术、相关技术面临的挑战以及该领域的关键研究发现。我们以自上而下的方式组织本综述，结构如下：第2节阐述我们从文献（重点关注过去十年）中收集相关工作的研究方法，并将流体仿真分为七个主要主题。第3节介绍了理解综述后续内容所需的物理背景及流体仿真采用的离散化方法。第4至10节分别对在上述七个主题中发现的文献进行讨论：第4节介绍用于加速第3节所述仿真模型实现的各种高级自适应、并行及数据驱动计算方法。随后三节详述更具体且更具挑战性的仿真场景：流体与不同材料的交互（第5节）、多相仿真（第6节）以及气液界面（第7节）。第8节与第9节分别讨论通过控制模拟流体的外观与运动来提升质量的艺术化手段。第10节探讨特殊流体。最后，第11节通过指出未来研究的关键方向总结全文。附录介绍并讨论了涵盖数值仿真、建模与渲染的流体仿真软件实现。   

2. 综述构建方法     
基于物理的流体仿真是一个活跃了数十年的研究领域，其研究融合了来自工程学、物理学、数学和计算机科学等多个不同学科的贡献。若一篇综述试图全面覆盖所有这些领域的范畴，则篇幅将过于庞大。此外，我们认为计算机图形学领域的研究者与实践者的关注点通常集中于上述方面的某个子集，因此我们据此构建了本次综述的结构如下。   

我们选择以《ACM图形学汇刊》（TOG）、《IEEE可视化与计算机图形学汇刊》（TVCG）及《计算机图形学论坛》（CGF）这三本公认最具影响力与代表性的计算机图形学期刊上发表的论文作为主要信息来源。由于本综述旨在涵盖近期研究趋势，我们纳入了这些期刊在过去十年间（2012年至2022年）发表的所有相关论文。此外，我们还收录了在重要图形学会议（如ACM SIGGRAPH/欧洲图形学计算机动画研讨会[SCA]、ACM SIGGRAPH及ACM SIGGRAPH Asia）上发表的若干论文。最后，我们也纳入了一些对近期研究产生显著影响的早期文献。总计我们收集并深入分析了符合上述标准的327篇论文。   

基于物理的流体仿真在计算机图形学中的起源可追溯至20世纪70年代"粒子系统"的发展[1]。然而，一个成熟且相对稳定的流体动画物理仿真系统直到上世纪末才得以实现[2]。在此后的十年间，各类模拟策略持续演进，重点聚焦于提升流体仿真的稳定性、精确性与效率。我们将在第3.3节讨论此方面的早期进展。随后，针对特定流体现象的研究与仿真效果的定制化工作开始涌现并逐渐兴起。   

随着我们进入2010年代——本综述论文聚焦的核心时期——流体仿真的主要研究方向已转向解决那些利用传统仿真方法难以实现的特定效果。伴随这一转变，机器学习技术的进步为神经网络与仿真算法的融合开辟了新途径，从而拓展了流体仿真领域的可能性边界。鉴于本综述旨在全面探讨该领域的当前进展，我们基于对这些文献的深入分析，将所收集的论文划分为七个相关主题，这些主题贯穿了过去十年的研究脉络。随后，我们在每个主题中选取了具有代表性的论文子集，并将对其进行更为详尽的探讨。   

![](./assets/206-1.png)   

图1展示了本综述结构的第一层级，其中包含了我们归纳出的七个主题。后续层级进一步细分为各子主题。这七个主要主题如下：     

- **先进计算方法**（第4节）：旨在充分利用高性能并行计算资源进行流体仿真的各类方法。    
- **流体与多材料耦合**（第5节）：模拟流体与不同形状、纹理的固体对象之间交互作用的方法。    
- **多相液体**（第6节）：模拟不同相态液体之间交互效应的方法。    
- **气液界面**（第7节）：处理气液界面受力主导流体运动的场景所涉及的方法。   
- **精细细节增强**（第8节）：专注于在细节层面保持/增强流体运动表现的方法。    
- **流体控制**（第9节）：允许视觉设计者控制流体仿真外观与风格的方法。   
- **特殊流体**（第10节）：模拟非常规流体的方法，例如高粘性/稀薄流体、对磁场敏感的流体，或那些严格意义上并非流体但具有类流体行为的材料。   

我们提出的七主题分类法，首要目的在于识别过去十年间的显著趋势。因此，这些主题的划分是基于收集到的文献中有相当一部分可归入各类别；换言之，这些主题反映了过去十年流体研究如何发展的"数据驱动型组织方式"。这与其他综述所采用的方法形成对比——后者通常是作者基于预先定义的理论驱动型分类框架对研究成果进行归类。    

通过分析文献中各主题的分布及其随时间演变的情况，我们可以获得有价值的洞察。图2展示了七个主题各自的论文数量。可以看出，尽管存在差异（某些主题的关注度高于其他），但每个主题都拥有相当数量的文献支撑，平均每年产生4至8篇顶级论文，这印证了我们所划分的主题能有效组织相关研究。图3进一步深化了这一洞察，展示了各主题逐年发表文章的数量分布。我们注意到，虽然部分主题的发表量呈上升趋势（例如先进计算方法，即图3中的红色曲线），但所有七个主题在过去十年间均保持"活跃"状态——这再次表明它们适合作为本综述的组织框架。   

![](./assets/206-2.png)

![](./assets/206-3.png)    

**3 流体仿真概述**     

计算机图形学中的流体仿真发展深深扎根于物理学史。19世纪，艾萨克·牛顿爵士、克洛德-路易·纳维等科学家对流体力学理解作出了重要贡献，为纳维-斯托克斯方程的建立铺平了道路。这些控制流体运动的方程构成了现代流体仿真算法的基础。    

本节将对流体仿真进行基础性介绍，并为后续综述内容提供背景知识。如需更全面理解流体仿真原理，建议参阅Bridson的专著[3]。关于基于拉格朗日观点的光滑粒子流体动力学及物质点法的具体知识，可分别参考Koschier等人[4]与Jiang等人[5]的综述文献。建议对本领域不熟悉的读者在继续阅读前先学习本节内容。我们将首先介绍流体仿真背后的相关物理原理，包括连续介质假设（第3.1节）与纳维-斯托克斯方程（第3.2节），随后概述该领域的早期发展（第3.3节），其中将简要阐述不同离散化策略的核心思想。   

![](./assets/206-表1.png)   

**表1** 总结了本综述中使用的主要符号表示。我们采用这些符号，并结合下标、上标及括号等形式，配合参数来指代这些物理量在不同条件下的对应量值，具体用法将在后文相关语境中说明。

**3.1 流体力学**  
自然界中的物质由原子和分子构成，它们彼此离散并由空间分隔。若在微观层面模拟流体以描述宏观现象，即便使用超级计算机，也往往需要数周甚至数月的计算时间。计算机图形学所追求的，是在效率与保真度之间达到平衡。为此，基于**连续介质假设**的流体力学，便成为了模拟其物理特性的基本层面。  

流体力学将物体建模为物质在其体内**连续分布**的实体，这种近似称为**连续介质假设**。这意味着，流体中任何无限小的体积元都被视为连续介质，也称为**流体微团**。正如朗道和栗弗席兹所述[6]，流体微团“相较于所考虑物体的体积非常小，但相较于分子间距则足够大”。

在流体力学中，**连续性方程**描述了物理量在时空中的输运，如公式(1)所示：  

![](./assets/206-公式1.png)   


